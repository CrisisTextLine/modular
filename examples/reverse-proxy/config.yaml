# Reverse Proxy Example Configuration

# Reverse Proxy configuration
reverseproxy:
  backend_services:
    global-default: "http://localhost:9001"
    tenant1-backend: "http://localhost:9002"
    tenant2-backend: "http://localhost:9003"
    specific-api: "http://localhost:9004"
  default_backend: "global-default"
  tenant_id_header: "X-Tenant-ID"
  require_tenant_id: false
  
  # Global response header configuration (applied to all backends)
  response_header_config:
    set_headers:
      X-Proxy-Version: "1.0"
      X-Powered-By: "Modular-ReverseProxy"
  
  # Per-backend configuration with response header rewriting
  backend_configs:
    specific-api:
      url: "http://localhost:9004"
      # Override/consolidate CORS headers from backend
      response_header_rewriting:
        set_headers:
          Access-Control-Allow-Origin: "*"
          Access-Control-Allow-Methods: "GET, POST, PUT, DELETE, OPTIONS"
          Access-Control-Allow-Headers: "Content-Type, Authorization, X-Tenant-ID"
          Access-Control-Max-Age: "86400"
        remove_headers:
          - "X-Internal-Header"  # Remove internal headers from backend

# ChiMux router configuration
chimux:
  basepath: ""
  allowed_origins:
    - "*"
  allowed_methods:
    - "GET"
    - "POST"
    - "PUT"
    - "DELETE"
    - "OPTIONS"
  allowed_headers:
    - "Content-Type"
    - "Authorization"
  allow_credentials: false
  max_age: 300

# HTTP Server configuration  
httpserver:
  host: "localhost"
  port: 8080
  read_timeout: "30s"
  write_timeout: "30s"
  idle_timeout: "120s"